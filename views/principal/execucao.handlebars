<style>
    .disabledbutton {
        pointer-events: none;
        opacity: 0.4;
    }

    .labelp {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        word-wrap: hyphenate;
        max-width: 300px;
        display: block;
    }

    .labelp>span {
        overflow: hidden;
    }
</style>
<script>
    function mostraSalvar() {
        var check = document.getElementById('checkProtocolo')
        var salvar = document.getElementById('salvar')
        if (check.checked) {
            salvar.style.display = 'inline'
        } else {
            salvar.style.display = 'none'
        }
    }
    window.onload = function () {
        var bloquear = document.getElementById('bloquear')

        if (bloquear.className == 'true') {
            bloquear.className = 'disabledbutton'
        }

    }
</script>
<div style="width: 98%;padding-left: 2%;padding-top: 0.5%;">
    {{#if proposta._id}}
    <div style="width: 100%;">
        <h5 class="header">{{cliente_proposta.nome}} - {{proposta.seq}}</h5>
    </div>
    {{/if}}

    <div class='btn-group col-12'>
        <div class='numero'>1</div>
        <a href='/gerenciamento/proposta/{{proposta._id}}/'
            class='btn btn-sm {{#if proposta.feito}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center'
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-house d-flex align-items-center"></i>&nbspProposta</a>
        <div class='numero'>2</div>
        <a href="/gerenciamento/visita/{{proposta._id}}"
            class="btn btn-sm {{#if vistoria.feito}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-gear d-flex align-items-center"></i>&nbspVisita
            Técnica</a>
        <div class='numero '>3</div>
        <a href="/gerenciamento/assinatura/{{proposta._id}}"
            class="btn btn-sm {{#if proposta.assinado}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-pencil d-flex align-items-center"></i>&nbspContrato</a>
        <div class='numero'>4</div>
        <a href="/gerenciamento/compra/{{proposta._id}}"
            class="btn btn-sm {{#if compra.feitonota}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-cart-check d-flex align-items-center"></i>&nbspCompra Sistema</a>
        <div class='numero'>5</div>
        <a href="/gerenciamento/trt/{{proposta._id}}"
            class="btn btn-sm {{#if documento.feitotrt}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-tools d-flex align-items-center"></i>&nbspTRT</a>
        <div class='numero ativo'>6</div>
        <a href="/gerenciamento/execucao/{{proposta._id}}"
            class="btn btn-sm {{#if documento.protocolado}} check-menu {{else}} botao-menu ativo{{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-paperclip d-flex align-items-center"></i>&nbspPlantas</a>
        <div class='numero'>7</div>
        <a href="/gerenciamento/equipe/{{proposta._id}}"
            class="btn btn-sm {{#if lista_equipe.feito}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-people d-flex align-items-center"></i>&nbspExecução</a>
        <div class='numero'>8</div>
        <a href="/gerenciamento/aceite/{{proposta._id}}"
            class="btn btn-sm {{#if documento.feitoaceite}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-check2-square d-flex align-items-center"></i>&nbspAceite Obra</a>
        <div class='numero'>9</div>
        <a href="/gerenciamento/almoxarifado/{{proposta._id}}"
            class="btn btn-sm {{#if documento.feitoalmox}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-layers d-flex align-items-center"></i>&nbspAlmoxarifado</a>
        <div class='numero'>10</div>
        <a href="/gerenciamento/financeiro/{{proposta._id}}"
            class="btn btn-sm {{#if documento.feitofaturado}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-calculator d-flex align-items-center"></i>&nbspFinanceiro</a>
        <div class='numero'>11</div>
        <a href="/gerenciamento/posvenda/{{proposta._id}}"
            class="btn btn-sm {{#if posvenda.feito}} check-menu {{else}} botao-menu {{/if}} d-flex align-items-center"
            style="border-bottom-left-radius: 30px;">&nbsp&nbsp<i
                class="bi bi-door-open d-flex align-items-center"></i>&nbspPós
            Venda</a>
    </div>

    <div id='bloquear' class='{{proposta.encerrado}}'>
        <div class="row mt-4" style="padding-left: 5%;">
            <div class='row fw-bold'>
                <div style="width: 51%;">
                    <label class='col-form-label'>Documento</label>
                </div>
                <div style="width: 17%;">
                    <label class='col-form-label'>Data</label>
                </div>
                <div style="width: 6%;">
                    <label class='col-form-label'>Salvar</label>
                </div>
                <div style="width: 4%;">
                    <label class='col-form-label'>Ver</label>
                </div>
            </div>
            <form action='/gerenciamento/salvarDocumento' enctype="multipart/form-data" method="post">
                <input type='hidden' name='id' value='{{proposta._id}}'>
                <input type='hidden' name='tipo' value='memorial'>
                <div class="row">
                    <div class="row">
                        <div class='col-md-2'>
                            <label class="col-form-label">Memorial Descritivo:</label>
                        </div>
                        <div class='col'>
                            <label class='col-form-label labelp'>{{documento.memorial}}</label>
                        </div>
                    </div>
                    <div class='col-md-6'>
                        <input class="form-control" type="file" name='files'>
                    </div>
                    <div class='col-md-2'>
                        <input type="date" class='form-control' name='dtmemorial' value='{{documento.dtmemorial}}'>
                    </div>
                    <div style="width: 70px;">
                        <button type='submit' class="btn btn-success" name='aplicar'><i class='bi bi-save'></i></button>
                    </div>
                    <div style="width: 70px;">
                        <a class="btn btn-primary" href='/gerenciamento/mostrarBucket/{{documento.memorial}}'
                            target="_blank"><i class='bi bi-eye'></i></a>
                    </div>
                </div>
            </form>

            <form action='/gerenciamento/salvarDocumento' enctype="multipart/form-data" method="post">
                <input type='hidden' name='id' value='{{proposta._id}}'>
                <input type='hidden' name='tipo' value='situacao'>
                <div class="row">
                    <div class="row">
                        <div class='col-md-2'>
                            <label class="col-form-label">Planta de Situação:</label>
                        </div>
                        <div class='col'>
                            <label class='col-form-label labelp'>{{documento.situacao}}</label>
                        </div>
                    </div>
                    <div class='col-md-6'>
                        <input class="form-control" type="file" name='files'>
                    </div>
                    <div class='col-md-2'>
                        <input type="date" class='form-control' name='dtsituacao' value='{{documento.dtsituacao}}'>
                    </div>
                    <div style="width: 70px;">
                        <button type='submit' class="btn btn-success" name='aplicar'><i class='bi bi-save'></i></button>
                    </div>
                    <div style="width: 70px;">
                        <a class="btn btn-primary" href='/gerenciamento/mostrarBucket/{{documento.situacao}}'
                            target="_blank"><i class='bi bi-eye'></i></a>
                    </div>
                </div>
            </form>

            <form action='/gerenciamento/salvarDocumento' enctype="multipart/form-data" method="post">
                <input type='hidden' name='id' value='{{proposta._id}}'>
                <input type='hidden' name='tipo' value='unifilar'>
                <div class="row">
                    <div class="row">
                        <div class='col-md-2'>
                            <label class="col-form-label">Diagrama Unifilar:</label>
                        </div>
                        <div class='col'>
                            <label class='col-form-label labelp'>{{documento.unifilar}}</label>
                        </div>
                    </div>
                    <div class='col-md-6'>
                        <input class="form-control" type="file" name='files'>
                    </div>
                    <div class='col-md-2'>
                        <input type="date" class='form-control' name='dtunifilar' value='{{documento.dtunifilar}}'>
                    </div>
                    <div style="width: 70px;">
                        <button type='submit' class="btn btn-success" name='aplicar'><i class='bi bi-save'></i></button>
                    </div>
                    <div style="width: 70px;">
                        <a class="btn btn-primary" href='/gerenciamento/mostrarBucket/{{documento.unifilar}}'
                            target="_blank"><i class='bi bi-eye'></i></a>
                    </div>
                </div>
            </form>

            <form action='/gerenciamento/salvarDocumento' enctype="multipart/form-data" method="post">
                <input type='hidden' name='id' value='{{proposta._id}}'>
                <input type='hidden' name='tipo' value='trifilar'>
                <div class="row">
                    <div class="row">
                        <div class='col-md-2'>
                            <label class="col-form-label">Diagrama Trifilar:</label>
                        </div>
                        <div class='col'>
                            <label class='col-form-label labelp'>{{documento.trifilar}}</label>
                        </div>
                    </div>
                    <div class='col-md-6'>
                        <input class="form-control" type="file" name='files'>
                    </div>
                    <div class='col-md-2'>
                        <input type="date" class='form-control' name='dttrifilar' value='{{documento.dttrifilar}}'>
                    </div>
                    <div style="width: 70px;">
                        <button type='submit' class="btn btn-success" name='aplicar'><i class='bi bi-save'></i></button>
                    </div>
                    <div style="width: 70px;">
                        <a class="btn btn-primary" href='/gerenciamento/mostrarBucket/{{documento.trifilar}}'
                            target="_blank"><i class='bi bi-eye'></i></a>
                    </div>
                </div>
            </form>
            <div class="row">
                <div class="col-md-7">
                    <form action='/gerenciamento/protocolar' method="post">
                        <input type='hidden' name='id' value='{{proposta._id}}'>
                        <div class="row mt-4">
                            <div class="mt-4" style="width: 340px;">
                                <div class="form-check" id='checkProto' onchange="mostraSalvar()">
                                    <input class="form-check-input" type="checkbox" {{check}} id="checkProtocolo">
                                    <label class="form-check-label mt-1" style="font-size: 15px;">
                                        Projeto protocolado na concessionária
                                    </label>
                                </div>
                            </div>
                            <div style='width: 190px;'>
                                <label>Data Envio</label>
                                <input type="date" class='form-control' name='dtprotocolo'
                                    value='{{documento.dtprotocolo}}'>
                            </div>
                            <div style='width: 100px;'>
                                <label>Deadline</label><br>
                                <label class='col-form-label'>{{documento.dtdeadline}}</label>
                            </div>
                            <div class="col-md-1 mt-3" id='salvar' style="display: {{salva}}">
                                <button type="submit" class='btn btn-success'><i class='bi bi-save'></i></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col">
                    <form action='/gerenciamento/salvarDocumento' enctype="multipart/form-data" method="post">
                        <input type='hidden' name='id' value='{{proposta._id}}'>
                        <input type='hidden' name='tipo' value='parecer'>
                        <div class="row" style="margin-top: 40px;">
                            <div class='col'>
                                <input class="form-control" type="file" name='files'>
                            </div>
                            {{#if documento.parecer}}
                            <div style="width: 70px;">
                                <a class="btn btn-primary" href='/gerenciamento/mostrarBucket/{{documento.parecer}}'
                                    target="_blank"><i class='bi bi-eye'></i></a>
                            </div>
                            {{/if}}                            
                            <div style="width: 70px;">
                                <button type='submit' class="btn btn-success" name='aplicar'><i
                                        class='bi bi-save'></i></button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div