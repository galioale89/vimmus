<style>
    .icone {
        font-size: 30px;
        color: rgb(2, 38, 78);
    }
</style>

<script>
    function mascara_dataini() {
        var data = document.getElementById('valDataIni')
        var dataini = document.getElementById('dataini')
        var dataord = document.getElementById('dataord')

        var novadata = data.value
        novadata = novadata.replace(novadata.substring(4, 5), "")
        novadata = novadata.replace(novadata.substring(6, 7), "")

        var currenTime = new Date()
        var year = currenTime.getFullYear()
        var month = currenTime.getMonth()
        var day = currenTime.getDate()
        var ano = novadata
        ano1 = ano.substring(0, 4)
        dia1 = ano.substring(6, 8)
        mes1 = ano.substring(4, 6)

        if (parseFloat(ano1) > parseFloat(year) || parseFloat(mes1) > parseFloat(month) + 1) {
            data.value = ''
            alert('Data maior que o dia de hoje.')
        } else {
            if (parseFloat(dia1) > parseFloat(day) && parseFloat(mes1) == parseFloat(month) + 1) {
                data.value = ''
                alert('Data maior que o dia de hoje.')
            } else {
                dataord.value = ano1 + mes1 + dia1
                dataini.value = dia1 + '/' + mes1 + '/' + ano1
            }
        }
    };
    function mascara_dataprev() {
        var data = document.getElementById('valDataPrev')
        var dataprev = document.getElementById('dataprev')
        var dataini = document.getElementById('valDataIni')

        var novadata = data.value
        novadata = novadata.replace(novadata.substring(4, 5), "")
        novadata = novadata.replace(novadata.substring(6, 7), "")

        var currenTime = new Date()
        var year = currenTime.getFullYear()
        var month = currenTime.getMonth()
        var day = currenTime.getDate()

        var ano = novadata
        ano1 = ano.substring(0, 4)
        dia1 = ano.substring(6, 8)
        mes1 = ano.substring(4, 6)

        if (dataini.value != '') {

            if (parseFloat(ano1) < parseFloat(year) || parseFloat(mes1) < parseFloat(month) + 1) {
                data.value = ''
                alert('Data deve ser maior que data inicial.')
            } else {
                if (parseFloat(ano1) == parseFloat(year) && parseFloat(mes1) == parseFloat(month) + 1 && parseFloat(dia1) < parseFloat(day)) {
                    data.value = ''
                    alert('Data deve ser maior que data inicial.')
                } else {
                    dataprev.value = dia1 + '/' + mes1 + '/' + ano1
                }
            }
        }else{
            alert('Primeiro escolha a data inicial.')
            data.value = ''
        }
    };
    //Slecionar estados e cidades
    window.onload = function () {

        var estados = document.getElementById('estado');
        var cidades = document.getElementById('cidade');

        /*
        cidades.onchange = function () {
            if (cidades.value !== "") {
                //Basta modificar está linha conforme a necessidade
                window.location = "pagina.asp?estado=" + estados.value + "&cidade=" + cidades.value
            }
        };
        */

        new dgCidadesEstados({
            estado: estados,
            cidade: cidades,
            estadoVal: '<%=Request("estado") %>',
            cidadeVal: '<%=Request("cidade") %>'
        });
    };
</script>
<div class="container mt-4">
    <form action="/projeto/novo/" method="post">
        <!-- Modal -->
        <div class="modal fade" id="custosModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Laçar custos detalhados do projeto</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">                        
                            <div class="col-md-4 text-end">
                                <label class='col-form-label col-form-label-sm fw-bold'>Descrição</label><br>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Kit Gerador:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Estrutura:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Cerca:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Postes de Condução de
                                        Fios:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Disjuntores:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>DPS:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Cabos:</label>
                                </div>
                                <div class="row mb-1">
                                    <label class='col-form-label col-form-label-sm fw-bold'>Outros Componentes:
                                </div>
                            </div>
                            <div class="col-md-1">
                                <label class='col-form-label col-form-label-sm fw-bold'>UN</label><br>
                                <input type='number' value='{{detalhe.unidadeEqu}}'
                                    class='form-control form-control-sm mb-1' name='unidadeEqu'>
                                <input type='number' value='{{detalhe.unidadeEst}}'
                                    class='form-control form-control-sm mb-1' name='unidadeEst'>
                                <input type='number' value='{{detalhe.unidadeCer}}'
                                    class='form-control form-control-sm mb-1' name='unidadeCer'>
                                <input type='number' value='{{detalhe.unidadePos}}'
                                    class='form-control form-control-sm mb-1' name='unidadePos'>
                                <input type='number' value='{{detalhe.unidadeDis}}'
                                    class='form-control form-control-sm mb-1' name='unidadeDis'>
                                <input type='number' value='{{detalhe.unidadeDPS}}'
                                    class='form-control form-control-sm mb-1' name='unidadeDPS'>
                                <input type='number' value='{{detalhe.unidadeCab}}'
                                    class='form-control form-control-sm mb-1' name='unidadeCab'>
                                <input type='number' value='{{detalhe.unidadeOcp}}'
                                    class='form-control form-control-sm mb-1' name='unidadeOcp'>
                            </div>
                            <div class="col-md-3">
                                <label type='number' class='col-form-label col-form-label-sm fw-bold'>R$
                                    Unitário</label><br>
                                <input type='number' value='{{detalhe.vlrUniEqu}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniEqu'>
                                <input type='number' value='{{detalhe.vlrUniEst}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniEst'>
                                <input type='number' value='{{detalhe.vlrUniCer}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniCer'>
                                <input type='number' value='{{detalhe.vlrUniPos}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniPos'>
                                <input type='number' value='{{detalhe.vlrUniDis}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniDis'>
                                <input type='number' value='{{detalhe.vlrUniDPS}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniDPS'>
                                <input type='number' value='{{detalhe.vlrUniCab}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniCab'>
                                <input type='number' value='{{detalhe.vlrUniOcp}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='vlrUniOcp'>
                            </div>
                            <div class="col-md-4">
                                <label class='col-form-label col-form-label-sm fw-bold'>R$ Total</label><br>
                                <input type='number' value='{{detalhe.valorEqu}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorEqu'>
                                <input type='number' value='{{detalhe.valorEst}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorEst'>
                                <input type='number' value='{{detalhe.valorCer}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorCer'>
                                <input type='number' value='{{detalhe.valorPos}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorPos'>
                                <input type='number' value='{{detalhe.valorDis}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorDis'>
                                <input type='number' value='{{detalhe.valorDPS}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorDPS'>
                                <input type='number' value='{{detalhe.valorCab}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorCab'>
                                <input type='number' value='{{detalhe.valorOcp}}'
                                    class='form-control form-control-sm mb-1' placeholder="R$" name='valorOcp'>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ok</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal -->

        <div class="row">
            <div class="row">
                <h5><i class="bi bi-box-arrow-in-right icone"></i> Cadastro de Projeto</h5>
                <hr>
            </div>
            <div class="col-md-6">
                <div class="row">
                    <div class="col-md-5 text-end">
                        <label for="nome" class="fw-bold col-form-label col-form-label-sm mb-2"> Nome do Projeto:
                        </label><br>
                        <label for="cliente" class="fw-bold col-form-label col-form-label-sm mb-2"> Cliente:
                        </label><br>
                        <label for="uf" class="fw-bold col-form-label col-form-label-sm mb-2"> Estado:
                        </label><br>
                        <label for="cidade" class="fw-bold col-form-label col-form-label-sm mb-2"> Cidade:
                        </label><br>
                        <label for="ptnprj" class="fw-bold col-form-label col-form-label-sm mb-2"> Potência do
                            Projeto:</label><br>
                        <label for="vendedor" class="fw-bold col-form-label col-form-label-sm mb-2"> Vendedor:
                        </label><br>
                        <!--<label for="percom" class="fw-bold col-form-label col-form-label-sm mb-2"> Comissão: </label><br>-->
                        <label for="inputState" class="fw-bold col-form-label col-form-label-sm mb-2">Custos:
                        </label><br>
                        <label class='fw-bold col-form-label col-form-label-sm mb-2'>Regime Tributário: </label><br>
                        <label class='fw-bold col-form-label col-form-label-sm mb-2'>Gestor Responsável:</label><br>
                        <label class='col-form-label col-form-label-sm fw-bold mb-2'>Data Inicio Projeto:</label><br>
                        <label class='col-form-label col-form-label-sm fw-bold mb-2'>Data Previsão de Entrega:</label>
                    </div>
                    <div class="col-md-7">
                        <input type="text" name="nome" id="nome" class="form-control form-control-sm mb-2">
                        <select class='form-select form-select-sm mb-2' name='cliente'>
                            {{#each clientes}}
                            <option value="{{_id}}">{{nome}}</option>
                            {{else}}
                            <option value=''>Nenhum cliente cadastrado</option>
                            {{/each}}
                        </select>
                        <!--<input type="text" name="cliente" id="cliente" class="form-control form-control-sm mb-2">-->
                        <select id="estado" name='uf' class='form-select form-select-sm mb-2'>
                        </select>
                        <select id="cidade" name='cidade' class='form-select form-select-sm mb-2'>
                        </select>
                        <input type="number" name="potencia" id="potencia" class="form-control form-control-sm mb-2"
                            placeholder="kWp" aria-placeholder="R$">
                        <select name='vendedor' class="form-select form-select-sm mb-2">
                            {{#each vendedor}}
                            <option value="{{_id}}">{{nome}}</option>
                            {{else}}
                            <option value=''>Nenhum vendedor cadastrado</option>
                            {{/each}}
                        </select>
                        <!--                  
                        <input type="number" name="comissao" id="comissao" class="form-control form-control-sm mb-2"
                            placeholder="%">     
                        -->
                        <select id="inputState" name='tipocusto' class="form-select form-select-sm mb-2">
                            <option>Diretos</option>
                            <option>Por Hora</option>
                        </select>
                        <select name='regime' class="form-select form-select-sm mb-2">
                            {{#each regime}}
                            <option value="{{_id}}">{{nome}}</option>
                            {{else}}
                            <option value=''>Nenhuma configuração encontrada</option>
                            {{/each}}
                        </select>
                        <select name='pessoa' class="form-select form-select-sm mb-2">
                            {{#each pessoas}}
                            <option value="{{_id}}">{{nome}}</option>
                            {{else}}
                            <option value=''>Nenhuma configuração encontrada</option>
                            {{/each}}
                        </select>
                        <!--
                        <input class='form-control form-control-sm mb-2' type='date' name='valDataIni' id='valDataIni'
                            placeholder='__/__/____' autocomplete="off" maxlength="10" onmouseout="mascara_dataini()">
                        <input class='form-control form-control-sm' type='date' name='valDataPrev' id='valDataPrev'
                            placeholder='__/__/____' autocomplete="off" maxlength="10" onmouseout="mascara_dataprev()">
                        -->
                        <input class='form-control form-control-sm mb-2' type='date' name='valDataIni' id='valDataIni'
                            onchange="mascara_dataini()">
                        <input class='form-control form-control-sm' type='date' name='valDataPrev' id='valDataPrev'
                            onchange="mascara_dataprev()">
                        <input type="hidden" name='dataord' id='dataord' value=''>
                        <input type="hidden" name='dataini' id='dataini' value=''>
                        <input type="hidden" name='dataprev' id='dataprev' value=''>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row">
                    <div class="col-md-4 text-end mb-3">
                        <label for="vlrorc" class="fw-bold col-form-label col-form-label-sm mb-2"> Valor Orçado do
                            Projeto:
                        </label><br>
                        <label for="vlreqi" class="fw-bold col-form-label col-form-label-sm mb-1"> Valor Kit Gerador:
                        </label><br>
                        <label class="fw-bold col-form-label col-form-label-sm"> Faturar Kit Gerador:
                        </label>
                    </div>
                    <div class="col-md-5">
                        <input type="number" name="valor" id="valor" class="form-control form-control-sm mb-2"
                            placeholder="R$" aria-placeholder="R$">
                        <input type="number" name="equipamento" id="equipamento"
                            class="form-control form-control-sm mb-2" placeholder="R$" aria-placeholder="R$">
                        <div class="form-check form-switch">
                            <input name='checkFatura' class="form-check-input" type="checkbox">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <label class='fw-bold col-form-label col-form-label-sm'>Complementos</label>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input name='estsolo' class="form-check-input" type="checkbox">
                            <label class="form-check-label col-form-label col-form-label-sm">
                                Estrutura de Solo
                            </label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-check">
                            <input name='cercamento' class="form-check-input" type="checkbox">
                            <label class="form-check-label col-form-label col-form-label-sm">
                                Cercamento
                            </label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input name='poste' class="form-check-input" type="checkbox">
                            <label class="form-check-label col-form-label col-form-label-sm">
                                Postes de Condução
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <a class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#custosModal"><i
                            class='bi bi-list-ul'></i> Lançar Custos
                        Detalhados do Orçamento
                    </a>
                </div>
                <div class="row mt-2 card" style="height: 150px;">
                    <div class="col-md-2">
                        <label class='fw-bold col-form-label col-form-label-sm'>Requisitos: </span>
                    </div>
                    <div class="col-md-9 mb-1">
                        <textarea name='requisitos' class="form-control" rows='3'
                            style="width: 540px;height: 110px;"></textarea>
                    </div>
                </div>
                <!--
                <div class="row mt-2">
                    <div class="col-md-2">
                        <label class='fw-bold col-form-label col-form-label-sm'>Orçamento: </span>
                    </div>
                    <div class="col-md-9">
                        <input class="form-control form-control-sm" id="formFileSm" type="file">
                    </div>
                </div>
                -->
                <div class="row mt-2">
                    <button type='submit' class='btn btn-success'> <i class='bi bi-layers'></i> Ir para Custos</button>
                </div>
            </div>
        </div>
    </form>
</div>