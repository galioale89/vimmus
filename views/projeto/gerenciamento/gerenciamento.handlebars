<style>
    .body {
        background-color: #001263e5;
        font-family: 'Roboto', Helvetica, sans-serif;
    }

    header {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 60px;
    }

    .lists {
        display: flex;
        flex: 1;
        width: 100%;
        cursor: pointer;
    }

    .lists .list {
        display: flex;
        flex-flow: column;
        flex: 1;

        width: 100%;
        min-width: 250px;
        max-width: 350px;
        height: 100%;
        min-height: 300px;

        background-color: rgba(255, 253, 253, 0.1);
        margin: 0 15px;
        padding: 8px;
        transition: all 0.2s linear;
    }

    .lists .list .list-item {
        background-color: #F3F3F3;
        border-radius: 8px;
        padding: 15px 20px;
        text-align: center;
        margin: 4px 0px;
    }

    .lists .list .item {
        background-color: #F3F3F3;
        border-radius: 8px;
        padding: 15px 20px;
        text-align: center;
        margin: 4px 0px;
    }
</style>
<!---  Modal --->
<div class='modal fade' id='formaequipe' tabindex="-1" aria-hidden="true">
    <div class='modal-dialog modal-xl'>
        <div class="modal-content">
            <div class="modal-header">
                <div class="row text-center" style="margin-top: 100px">
                    <h2><i class="bi bi-people"></i> Criação de Equipes</h2><br>
                    <p style="color: white;">Aqui serão ser criadas as equipes que poderão ser
                        vinculadas aos projetos
                    </p>
                </div>
            </div>
            <div class="modal-body">
                <form method='post' action='/pessoa/criarequipe'>
                    <div class="body">
                        <div class="card-body">
                            <div class="row" style="margin-top: 100px;">
                                <div class="col-md-5">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label class="col-form-label col-form-label-sm fw-bold"
                                                style="color: white;">Nome
                                                Equipe:</label>
                                        </div>
                                        <div class="col-md-8">
                                            <input type='text' name='nome' class="form-control">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <button class="col-6 btn btn-success btn-lg"
                                            style="margin-left: 100px; margin-block-start: 60px;"
                                            onclick="getItemValue()">Criar
                                            Equipe</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="lists">
                                        <div class="list">
                                            <label
                                                class="col-form-label col-form-label-md fw-bold text-center">Profissionais
                                                Disponíveis</label>
                                            {{#each instaladores}}
                                            <div class="list-item" style='color: black;' draggable="true"
                                                name='{{_id}}'>{{nome}}
                                            </div>
                                            {{else}}
                                            {{/each}}
                                        </div>
                                        <div class="list" id='funins' name='funins'>
                                            <label
                                                class="col-form-label col-form-label-md fw-bold text-center">Profissionais
                                                Alocados</label>
                                        </div>
                                    </div>
                                </div>
                                <input type='hidden' class='ins0' name='ins0' id='ins0' value=''>
                                <input type='hidden' class='ins1' name='ins1' id='ins1' value=''>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type='button' class='btn btn-secondary' data-bs-dismiss='modal'>Ok</button>
            </div>
        </div>
    </div>
</div>
<!-- End Modal -->

<div class="container card mt-2">

    <div class="row">
        <h4 class="shadow p-3 mb-2 bg-body rounded" style="color:white;background: linear-gradient(200deg, rgb(73, 91, 182), rgb(43, 57, 128), rgb(16, 32, 110));">Projeto: {{projeto.nome}} </h4>
    </div>

    <div class="btn-group">
        <a href="/customdo/instalacao/{{projeto._id}}" class="btn btn-primary"><i class="bi bi-tools"></i>
            Instalação</a>
        <a href="/customdo/projetista/{{projeto._id}}" class="btn btn-primary"><i class="bi bi-pencil"></i>
            Projetista</a>
        <a href="/customdo/gestao/{{projeto._id}}" class="btn btn-primary"><i class="bi bi-puzzle"></i> Gestão</a>
        <a href="/gerenciamento/{{projeto._id}}" class="btn btn-primary active"><i
                class="bi bi-cursor"></i>Gerenciamento</a>
        <a href="/gerenciamento/tributos/{{projeto._id}}" class="btn btn-primary"><i
                class="bi bi-calculator"></i>Tributos</a>
    </div>

    <form action='/gerenciamento' method="post">

        <input type="hidden" name="id" value='{{projeto._id}}'>

        <div class="row g-3">

            <div class="col-md-5">

                <div class="">
                    <label for="combustivel" class="fw-bold col-sm-10 col-form-label col-form-label-sm">Estadia</label>
                    </label>
                    <div class="row g-3">
                        <div class="col">
                            <label for="trabalho" class="col-sm-10 col-form-label col-form-label-sm">R$ Diária: </label>
                            <div class="input-group input-group-sm mb-1">
                                <input type="number" name="vlrdia" value='{{projeto.vlrdia}}' class="form-control">
                            </div>
                        </div>
                        <div class="col">
                            <label for="valor" class="col-form-label col-form-label-sm">Num. de Diárias: </label>
                            <div class="input-group input-group-sm mb-1">
                                <input disabled type="number" name="numdia" value='{{projeto.diastr}}'
                                    class="form-control">
                            </div>
                        </div>
                        <div class="col">
                            <label for="total" class="col-sm-6 col-form-label col-form-label-sm">Total</label>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input disabled type="number" class="form-control" name="tothtl"
                                    value='{{projeto.tothtl}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="">
                    <label for="combustivel"
                        class="fw-bold col-sm-10 col-form-label col-form-label-sm">Combustível</label>
                    <div class="row g-3">
                        <div class="col">
                            <label for="unidade" class="col-sm-7 col-form-label col-form-label-sm">Distância: </label>
                            <div class="input-group input-group-sm mb-1">
                                <input type="number" name="discmb" value='{{projeto.discmb}}' class="form-control">
                            </div>
                        </div>
                        <div class="col">
                            <label for="trabalho" class="col-sm-6 col-form-label col-form-label-sm">R$ Litro:</label>
                            <div class="input-group input-group-sm mb-1">
                                <input type="number" name="ltocmb" value='{{projeto.ltocmb}}'
                                    class="form-control col-sm-2">
                            </div>
                        </div>
                        <div class="col">
                            <label for="total" class="col-form-label col-form-label-sm">R$ Total:</label>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input disabled type="number" class="form-control" name="totcmb"
                                    value='{{projeto.totcmb}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="">
                    <label for="alimentacao"
                        class="fw-bold col-sm-10 col-form-label col-form-label-sm">Alimentação</label>
                    <div class="row g-3">
                        <div class="col">
                            <label for="trabalho" class="col-form-label col-form-label-sm">R$ Valor por Pessoa:</label>
                            <div class="input-group input-group-sm mb-1">
                                <input type="number" name="vlrali" value='{{projeto.vlrali}}' class="form-control">
                            </div>
                        </div>
                        <div class="col">
                            <label for="total" class="col-form-label col-form-label-sm">R$ Total: </label>
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input disabled type="number" class="form-control" name="totlai"
                                    value='{{projeto.totali}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 card mt-4">
                <div class="row mt-2">
                    <div class="row">
                        <label class="fw-bold col-md-6 col-form-label col-form-label-sm">Reserva</label>
                        <div class="col">
                            <label class="fw-bold col-md-5 col-form-label col-form-label-sm">R$
                                {{projeto.reserva}}</label>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Reserva Gerencial:
                        </label>
                        <div class="col">
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control form-control-sm" id="resger" name="resger"
                                    value='{{projeto.resger}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Reserva
                            Contingência: </label>
                        <div class="col">
                            <div class="input-group input-group-sm mb-1">
                                <label class='fw-bold col-form-label col-form-label-sm'>R$
                                    {{projeto.rescon}}</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Adicional: </label>
                        <div class="col">
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control form-control-sm" id="conadd" name="conadd"
                                    value='{{projeto.conadd}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Imprevisto
                            Elétrico:</label>
                        <div class="col">
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control form-control-sm" id="impele" name="impele"
                                    value='{{projeto.impele}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Seguro:</label>
                        <div class="col">
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control form-control-sm" id="seguro" name="seguro"
                                    value='{{projeto.seguro}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Cercamento:</label>
                        <div class="col">
                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control form-control-sm" id="outcer" name="outcer"
                                    value='{{projeto.outcer}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <label class="fw-bold col-sm-6 col-form-label col-form-label-sm">Postes de
                            Condução:</label>
                        <div class="col">

                            <div class="input-group input-group-sm mb-1">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control form-control-sm" id="outpos" name="outpos"
                                    value='{{projeto.outpos}}' aria-label="R$ ">
                                <span class="input-group-text">.00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class='col-md-3 mt-4 card'>
                <div class="row mb-1 mt-2">
                    <label for="diastr" class="fw-bold col-md-7 col-form-label col-form-label-sm">Total de
                        Horas:</label>
                    <div class="col">
                        <label for="tothrs"
                            class="fw-bold col-md-5 col-form-label col-form-label-sm">{{projeto.tothrs}}</label>
                    </div>
                </div>
                <hr>
                <div class="col">
                    <div class="row mb-1 mt-2">
                        <label for="diastr" class="fw-bold col-md-7 col-form-label col-form-label-sm">Horas
                            Instalação:</label>
                        <div class="col">
                            <label for="diastr"
                                class="fw-bold col-md-5 col-form-label col-form-label-sm">{{projeto.trbint}}</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-7">
                            <label for="equipe" class="col-form-label col-form-label-sm fw-bold">Equipe
                                Instaladores:
                            </label>
                        </div>
                        <div class="col-md-5">
                            <input type="number" name="equipe" value='{{projeto.equipe}}'
                                class="form-control form-control-sm">
                        </div>
                    </div>
                    <div class="row">
                        <label for="diastr" class="fw-bold col-md-7 col-form-label col-form-label-sm">Dias
                            da Obra:</label>
                        <div class="col">
                            <label for="diastr"
                                class="fw-bold col-md-4 col-form-label col-form-label-sm">{{projeto.diastr}}</label>
                        </div>
                    </div>
                    <hr>
                    <div class="row col-12 mx-auto">
                        <!-- <a class='btn btn-sm btn-primary mb-2' data-bs-toggle="modal" data-bs-target='#formaequipe'><i
                                class='bi bi-people'></i>Equipe</a>-->
                        <a href='/pessoa/formaequipe/{{projeto._id}}' class='btn btn-sm btn-primary mb-2'><i class='bi bi-people'></i> Equipe</a>        
                    </div>
                    <div class="row col-12 mx-auto">
                        <button type='submit' class='btn btn-sm btn-success'> <i class="bi bi-check-circle"></i> Aplicar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 card mt-2">
                <label for="int" class="fw-bold col-form-label col-form-label-sm">INSTALAÇÃO</label>
                <div class="row">
                    <div class="col-md-5">
                        <label for="trbint" class="col-form-label col-form-label-sm">Horas
                            Trabalhadas:</label>
                    </div>
                    <div class="col-md-4">
                        <label for="trbint" class="col-form-label col-form-label-sm">{{projeto.trbint}}</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-5">
                        <label for="trbint" class="fw-bold col-form-label col-form-label-sm">Custo
                            Total:</label>
                    </div>
                    <div class="col-md-6">
                        <label for="totint" class="fw-bold col-form-label col-form-label-sm">R$
                            {{projeto.totint}}</label>
                    </div>
                </div>
            </div>

            <div class="col-md-4 card mt-2">
                <label for="pro" class="fw-bold col-sm-5 col-form-label col-form-label-sm">PROJETISTA</label>
                <div class="row">
                    <div class="col-md-5">
                        <label for="trbpro" class="col-form-label col-form-label-sm">Horas Trabalhadas:</label>
                    </div>
                    <div class="col-md-6">
                        <label for="trbpro" class="col-form-label col-form-label-sm">{{projeto.trbpro}}
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-5">
                        <label for="totpro" class="fw-bold col-form-label col-form-label-sm">Custo Total:</label>
                    </div>
                    <div class="col-md-6">
                        <label for="totpro" class="fw-bold col-form-label col-form-label-sm">R$
                            {{projeto.totpro}}</label>
                    </div>
                </div>
            </div>
            <div class="col-md-4 card mt-2">
                <label for="ges" class="fw-bold col-sm-5 col-form-label col-form-label-sm">GESTÃO</label>
                <div class="row">
                    <div class="col-md-5">
                        <label for="trbges" class="col-form-label col-form-label-sm">Horas Trabalhadas:</label>
                    </div>
                    <div class="col-md-6">
                        <label for="trbges" class="col-form-label col-form-label-sm">{{projeto.trbges}}</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-5">
                        <label for="totges" class="fw-bold col-form-label col-form-label-sm">Custo Total:</label>
                    </div>
                    <div class="col-md-6">
                        <label for="totges" class="fw-bold col-form-label col-form-label-sm">R$
                            {{projeto.totges}}</label>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
    const list_items = document.querySelectorAll('.list-item');
    const lists = document.querySelectorAll('.list');

    let draggedItem = null;

    for (let i = 0; i < list_items.length; i++) {
        const item = list_items[i];

        item.addEventListener('dragstart', function () {
            draggedItem = item;
            setTimeout(function () {
                item.style.display = 'none';
            }, 0)
        });

        item.addEventListener('dragend', function () {
            this.className = 'item';
            setTimeout(function () {
                draggedItem.style.display = 'block';
                draggedItem = null;
            }, 0);
        })

        for (let j = 0; j < lists.length; j++) {
            const list = lists[j];

            list.addEventListener('dragover', function (e) {
                e.preventDefault();
            });

            list.addEventListener('dragenter', function (e) {
                e.preventDefault();
                this.style.backgroundColor = 'rgba(0, 0, 0, 0.2)';
            });

            list.addEventListener('dragleave', function (e) {
                this.style.backgroundColor = 'rgba(0, 0, 0, 0.1)';
            });

            list.addEventListener('drop', function (e) {

                console.log('drop');
                this.append(draggedItem);
                this.style.backgroundColor = 'rgba(0, 0, 0, 0.1)';
            });
        }
    }

    function getItemValue() {
        const item = document.querySelectorAll('.item');
        for (i = 0; i < item.length; i++) {
            const insitem = document.getElementsByClassName(item[i].getAttribute('class'));
            var element = insitem[i].innerText;
            switch (i) {
                case 0:
                    var insdes = document.getElementById('ins0');
                    insdes.value = element;
                    break;
                case 1:
                    var insdes = document.getElementById('ins1');
                    insdes.value = element
                    break;
            }
        }
    }
</script>